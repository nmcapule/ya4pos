{{ define "layouts/base.html" }}
<html>
    <head>
        <title>{{ .Title }}</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pocketbase/0.8.0-rc1/pocketbase.umd.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
        >
            window.pb = new PocketBase("/");
            Alpine.start();
        </script>
    </head>
    <body>
        <script>
            async function __initializePocketBase() {
                window.pb = new PocketBase("/");

                // Try to authenticate using cookies.
                window.pb.authStore.loadFromCookie(document.cookie);
                if (!window.pb.authStore.isValid) {
                    try {
                        await window.pb.collection("users").authRefresh();
                    } catch (_) {
                        window.pb.authStore.clear();
                    }
                }
            }
        </script>
        <div x-init="__initializePocketBase()" style="display: none"></div>
        {{ .Body }}
    </body>
</html>
{{ end }}
